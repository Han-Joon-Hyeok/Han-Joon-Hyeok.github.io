---
title: "LLCF 개념 및 장애 전파 작동 원리"
date: 2025-08-28 15:30:00 +0900
categories: [Network]
tags: []
use_math: true
---

# LLCF

## 개념

LLCF(Link Loss Carry Forward)는 네트워크 장비에서 한쪽 링크에 장애가 발생할 경우, 연결된 반대편 포트에도 링크 다운 상태를 전파하여 장애를 신속하게 인지하고 대체 경로로 트래픽을 우회하도록 돕는 기능이다.

네트워크 장비는 한쪽 인터페이스의 수신부(RX)에서 Link Down을 감지하면, 같은 장비의 송신부(TX)도 신호를 중단한다. 그러면 반대편 장비가 즉시 장애를 인식할 수 있는데, 이를 통해 대체 경로로 빠른 절체(Failover)가 가능해진다.

참고로 LLCF는 표준 프로토콜이 아닌 기능이다. 그래서 네트워크 장비 회사마다 LLCF 기능을 구현하는 방법은 모두 다르다. LLCF는 전통적으로 물리 계층(L1)에서 구현되는 기능이지만, MPLS-TP나 Pseudo Wire 환경에서는 패킷 계층(L2.5~3)에서 OAM 메시지(CSF, RDI)를 통해 동일한 효과를 구현하기도 한다. 전자는 단순히 신호를 끊어 반대편이 Link Down을 인지하게 하는 방식이고, 후자는 장애 원인까지 구체적으로 전달할 수 있다는 차이가 있다. LLCF는 표준 OAM의 한계를 보완할 수 있는데, OAM 계층이 LOC/Loss Alarm을 설정하고 RDI/CSF를 발생시킨다. 즉, LLCF는 OAM이 움직이도록 트리거 역할을 하는 것이다.

## 용어 정의

- 링크: 두 장비를 연결하는 물리적 전송 경로를 의미한다. 케이블(광/UTP) + 케이블이 꽂힌 포트 양 끝을 일컫는다.
- 포트: 장비에서 케이블을 꽂을 수 있는 물리적/논리적 인터페이스를 의미한다.
    - 종류
        - UNI(User Network Interface): 고객 ↔ 사업자를 연결하는 인터페이스
        - NNI(Network-to-Network Interface): 사업자 ↔ 사업자를 연결하는 인터페이스
        - AC Port(Attachment Circuit Port): UNI 쪽에서 고객 회선이 붙는 포트

## 필요성

LLCF의 필요성은 세 가지로 정리할 수 있다. 설명의 편의를 위해 장애가 발생한 장비를 head, 반대편에 위치한 장비를 tail라고 하자.

### 1. 장애 전파

만약 head의 UNI 구간 수신부(RX)에서 장애가 발생해서 더 이상 사용자가 보내는 신호를 반대편 장비로 보낼 수 없다고 해보자. 이를 반대편 장비에 알리지 않으면 어떻게 될까? 반대편 장비인 tail은 head가 수신이 가능한 상태라고 인식하고 트래픽을 head 방향으로 보내게 된다. 하지만 head 수신부는 장애가 난 상태이므로 트래픽을 정상적으로 받을 수도 없고 이를 사용자에게 전달할 수도 없다. 결국 tail에서 보낸 트래픽은 head 장비에 도달하더라도 폐기되거나 손실되며, 결국 서비스는 단절된다. 더 큰 문제는 tail 장비는 여전히 링크가 살아 있다고 착각하기 때문에 절체(Failover) 동작을 하지 못한다는 점이다.

### 2. 빠른 절체

1번과 이어지는 맥락으로 장애가 발생했을 때 이를 반대편까지 신속히 전파해야만 양쪽 장비가 동시에 장애를 인식하고, 보호 경로나 백업 회선으로 빠르게 절체할 수 있다.

### 3. 서비스 안정성

LLCF를 통해 고객 트래픽이 무의미하게 죽은 링크로 들어가는 것을 방지하고, 가용성을 확보할 수 있다.

## 작동 과정

장비마다 구체적인 작동 과정은 다르지만, MPLS 프로토콜을 사용하는 네트워크 장비에서 작동하는 LLCF 기준으로 개념적인 작동 과정는 다음과 같다.

### 1. 장애 감지(head 장비 RX)

head 장비가 UNI 구간의 AC Port(RX)에서 들어오는 이더넷 신호에서 장애를 감지한다. 장애가 발생하는 상황은 다음의 표와 같이 정리할 수 있다.

| 유형 | 설명 | 원인 | 계층 |
| --- | --- | --- | --- |
| LOS(Loss of Signal) | RX 포트에 광 신호가 들어오지 않는 경우 | 광케이블 단선, 장거리 전송 시 발생하는 감쇠로 수신 감도 이하로 떨어지는 광 파워 부족, 반대편 장비의 송신부(TX) 레이저 다이오드 꺼짐 등 | L1 |
| LOC(Loss of Continuity) | OAM 세션에서 3.3ms 간격으로 전송하는 메시지인 CCM(Continuity Check Message)를 3회 연속 수신하지 못한 경우 | 반대편 장비 장애 발생, 물리적 링크 장애(LOS)로 인해 OAM 계층까지 전파되지 않음 등 | L2.5 ~ 3 |

### 2. OAM 메시지 생성(head 장비)

물리적으로 TX를 바로 끊지 않고, MPLS OAM 메시지를 생성한다. 이 메시지에는 다음과 같은 정보를 담을 수 있다.

- CSF(Client Signal Fail): 클라이언트 신호 문제 알림. UNI/AC 포트 쪽에서 장애가 발생하면 ‘내가 클라이언트 신호를 못 받고 있다’는 사실을 반대편 장비에 알려주는 OAM 신호
- RDI(Remote Defect Indication): 원격 결함 신호. ‘내 쪽에서 네가 보낸 신호를 제대로 받지 못하고 있다’는 사실을 반대편(원격)에 알려주는 신호
- AIS(Alarm Indication Signal): 상위 서비스로 장애 전파

### 3. TX 동작(head 장비)

head 장비의 TX 포트는 구현에 따라 두 가지 반응 중 하나를 한다.

1. OAM 메시지를 계속 전송하여 장애 상황을 패킷으로 알린다.
2. TX 신호 자체를 끊어서 상대편도 물리적 장애가 발생한 것을 감지한다.

MPLS LLCF는 1번을 기본으로 하지만, 일부 장비에서는 L1 LLCF와 연계해서 TX도 끊을 수 있다.

### 4. 반대편(tail 장비) 수신

tail 장비는 head 장비에서 보낸 OAM 메시지를 수신한다. 수신부(RX)가 받는 신호 중 장애 알림을 확인하고 Link Down을 선언한다. tail의 TX도 필요에 따라 Down 처리하거나, RDI 메시지를 되돌려서 head에 알릴 수 있다.

### 5. 양단 동기화 및 절체

위의 과정을 통해 head와 tail 양쪽이 동시에 ‘이 경로는 죽었다’는 상태를 인식하게 된다. 서비스 계층(Pseudo Wire)은 이를 감지하고 대체 경로로 절체를 수행한다.

# 참고자료

- [LLCF(Link Loss Carry Forward)](https://itnews.tistory.com/370) [티스토리]
- [LLCF(Link Loss Carry Forward) 설정하기](https://m.blog.naver.com/it-network/222462734920) [네이버 블로그]
- [LLCF 란 무엇이며 왜 필요한 것인가?](https://cezacx2.tistory.com/1086) [티스토리]