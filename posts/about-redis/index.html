<!DOCTYPE html><html lang="ko-KR" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.3.0" /><meta property="og:title" content="Redis 개념, 장점과 단점, Docker 사용 예시 정리" /><meta name="author" content="Joon Hyeok Han" /><meta property="og:locale" content="ko_KR" /><meta name="description" content="Redis" /><meta property="og:description" content="Redis" /><link rel="canonical" href="https://han-joon-hyeok.github.io/posts/about-redis/" /><meta property="og:url" content="https://han-joon-hyeok.github.io/posts/about-redis/" /><meta property="og:site_name" content="Dev Joon" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-10-03T23:56:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Redis 개념, 장점과 단점, Docker 사용 예시 정리" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@Joon Hyeok Han" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Joon Hyeok Han"},"dateModified":"2023-10-03T23:56:00+09:00","datePublished":"2023-10-03T23:56:00+09:00","description":"Redis","headline":"Redis 개념, 장점과 단점, Docker 사용 예시 정리","mainEntityOfPage":{"@type":"WebPage","@id":"https://han-joon-hyeok.github.io/posts/about-redis/"},"url":"https://han-joon-hyeok.github.io/posts/about-redis/"}</script><title>Redis 개념, 장점과 단점, Docker 사용 예시 정리 | Dev Joon</title><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/img/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/img/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/img/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/img/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/img/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/img/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/img/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/img/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/img/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/img/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/img/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/img/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/manifest.json"><meta name='msapplication-config' content='/assets/img/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/img/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-SKST7KNWSJ"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-SKST7KNWSJ'); }); </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/profile.jpg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Dev Joon</a></div><div class="site-subtitle font-italic">성장하는 개발자, 한준혁입니다.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/Han-Joon-Hyeok" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://twitter.com/" aria-label="twitter" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['joonhyeok.han','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Redis 개념, 장점과 단점, Docker 사용 예시 정리</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Redis 개념, 장점과 단점, Docker 사용 예시 정리</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Tue, Oct 3, 2023, 11:56 PM +0900" > Oct 3, 2023 <i class="unloaded">2023-10-03T23:56:00+09:00</i> </span> by <span class="author"> Joon Hyeok Han </span></div><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="5548 words">30 min</span></div></div><div class="post-content"><h1 id="redis">Redis</h1><h2 id="등장-배경">등장 배경</h2><p>서버 프로그램이 데이터를 영구적으로 저장하기 위해서 데이터베이스를 사용한다. 데이터베이스는 주로 데이터 간의 관계를 정의한 RDBMS(Relational DataBase Management System)를 사용한다.</p><p>RDBMS는 데이터 간의 복잡한 관계를 보여줄 때 매우 효과적이다. 하지만 하드 디스크에 데이터를 저장하고 읽다보니 처리해야 하는 쿼리가 많아지면 연산이 느려질 수 밖에 없다.</p><p>이러한 RDBMS의 단점을 극복하기 위해 RDBMS 방식을 탈피한 NoSQL이 등장했다. NoSQL는 아래와 같이 여러 종류가 존재한다.</p><ul><li>연관된 그래프 형식의 데이터를 저장하는 Graph Store<li>Column 위주로 데이터를 저장하는 Column Store<li>비정형 대량 데이터를 저장하기 위한 Document Store<li>메모리 기반으로 빠르게 데이터를 읽고 저장하는 Key-Value Store</ul><h2 id="redis란-무엇인가">Redis란 무엇인가?</h2><p>Redis는 NoSQL 중에서 Key-Value Store에 해당한다.</p><p><strong>Re</strong>mote <strong>Di</strong>ctionary <strong>S</strong>erver의 약자로 ‘원격 사전형 자료구조 서버’로 해석할 수 있다.</p><h3 id="장점">장점</h3><ol><li>RDBMS는 디스크를 기반으로 작동하지만, Redis는 메모리 기반 데이터베이스이기 때문에 속도가 훨씬 빠르다.<li>길고 복잡한 쿼리의 결과를 캐싱해두고, 쿼리의 결과가 바뀔 수 있는 이벤트가 발생할 때마다 캐싱하면 서비스 속도를 향상시킬 수 있다.</ol><h3 id="단점">단점</h3><ol><li>메모리 기반 저장소이기 때문에 별도의 백업 처리 없이 서버가 종료되거나 재시작하면 데이터를 잃을 수 있다.<li>싱글 스레드로 작동하기 때문에 다중 처리나 동시성이 요구되는 작업에는 적합하지 않다.</ol><h3 id="참고-디스크-io-가-메모리ram에-접근하는-것보다-느린-이유">참고. 디스크 I/O 가 메모리(RAM)에 접근하는 것보다 느린 이유?</h3><p>이를 이해하기 위해서는 하드웨어 관점에서 메모리를 살펴볼 필요가 있다. 메모리는 RAM 과 ROM 으로 구분할 수 있다.</p><p><strong>1. RAM(Random Access Memory)</strong></p><p>램은 내부적으로 저장하는 공간을 따로 마련하지 않아서 전류가 흐르지 않으면 데이터가 사라진다. 어떤 위치에 쓰여있는 데이터든 동일한 시간에 접근하며, 시간복잡도는 O(1)이다.</p><p>2<strong>. ROM(Read Only Memory)</strong></p><p>롬은 소자(전자 부품) 사이에 0과 1을 저장할 수 있는 공간이 있어서 전류가 흐르지 않더라도 데이터가 보존된다. 기본적으로 읽기 작업만 가능하지만, 기술이 발전하면서 쓰기 작업도 가능해져서 이름 자체의 의미는 많이 희미해졌다. 읽고 쓰는 것이 가능한 플래시 메모리는 크게 아래와 같이 구분된다.</p><ul><li>NAND 게이트 기반<ul><li>SSD, USB 에 사용<li>데이터를 저장하는 공간(셀)이 직렬 형태로 이루어져있어서 데이터를 순차적으로 읽어내기 때문에 Read 는 느리다.<li>메모리의 블록이 여러 페이지로 나누어져 있어서 Write 와 Erase 는 빠르다.<li>삼성, SK 하이닉스에서 주로 제조하는 제품.</ul><li>NOR 게이트 기반<ul><li>컴퓨터 바이오스, 펌웨어 저장에 사용<li>셀이 병렬 형태로 이루어져 있어서 Random Access 로 Read 속도가 빠르다.<li>반대로 Write나 Erase는 모든 블록을 지워야 하기 때문에 속도가 느리다.</ul></ul><p>참고로 HDD는 ROM이 아니다. 기술의 발전으로 SDD가 HDD처럼 사용 가능해졌기 때문에 이 글에서 디스크는 SDD 를 의미한다. 즉, 디스크 I/O 가 메모리에 접근하는 것이 느린 이유는 SDD가 NAND 게이트 기반 플래시 메모리이고 데이터를 순차적으로 읽기 때문에 Random Access가 불가능하기 때문이다.</p><h2 id="자료구조">자료구조</h2><p>Redis는 Strings, Set, Sorted Set, Hash, List 등 다양한 자료구조를 제공한다.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/2023/2023-10-03-about-redis/1.png" alt="1.png" /></p><p>출처: <a href="https://forum.redis.com/t/about-redis-commands-data-structures/13">redisforum</a></p><p>모든 자료구조를 다루기에는 양이 많기 때문에 일부만 살펴보자.</p><h3 id="strings">Strings</h3><ul><li>일반적인 문자열<li>최대 512MB 크기를 가지며, binary data, JPEG 이미지도 저장 가능<li>단순 증감 연산에 유리함</ul><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>redis&gt; SET num 42
<span class="s2">"OK"</span>
redis&gt; GET num
<span class="s2">"42"</span>
redis&gt; incr num
<span class="o">(</span>integer<span class="o">)</span> 43
redis&gt; GET num
<span class="s2">"43"</span>
</pre></table></code></div></div><h3 id="lists">Lists</h3><ul><li>string 의 연결 리스트. 데이터를 순서대로 저장한다.<li>중간에 데이터를 추가하거나 삭제하는 연산이 느리다. 그래서 연결 리스트의 맨 앞이나 맨 끝에서 데이터를 추가하거나 삭제한다. (push, pop 연산)<li>메세지 큐로 사용하기 적절하다.<ul><li>메세지 큐는 다른 프로세스와 데이터를 통신을 하기 위한 방법이다.<li>메세지를 전송하는 생산자(Producer)로 취급되는 컴포넌트가 메세지를 메세지 큐에 추가한다.<li>해당 메세지는 소비자(Consumer)로 취급되는 다른 컴포넌트가 메세지를 검색하고 사용해서 어떤 작업을 수행할 때까지 메세지 큐에 저장된다.<li>각 메세지는 하나의 소비자에 의해 한 번만 처리될 수 있기 때문에 메세지 큐를 이용하는 방식을 일대일 통신이라고 부른다.<li>예를 들어, 사이트에서 회원가입용 메일 전송, 비밀번호 재설정 메일 전송 등 다양한 이메일 서비스가 있다고 해보자. 각 서비스는 이메일을 메세지 큐에 넣는다. 이메일 전송 전용 서비스(메세지 큐)는 어느 서비스가 생산자(Producer)인지 상관없이 소비자(Consumer)가 메세지 큐에 쌓인 메세지를 처리한다. 즉, 이메일이 보내져야 하는 곳으로 반드시 이메일이 전송된다는 것이다.</ul></ul><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/2023/2023-10-03-about-redis/2.png" alt="2.png" /></p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>    출처: [메시지 큐에 대해 알아보자!](https://tecoble.techcourse.co.kr/post/2021-09-19-message-queue/) [Tecoble]

- Redis에 적용하면, 소셜 네트워크의 타임라인 기능을 구현할 때 새로운 글이 올라오면 `LPUSH` 로 추가하고, `LRANGE` 명령어를 사용해서 일정한 개수의 데이터를 고정적으로 반환할 수 있다.
</pre></table></code></div></div><h2 id="사용법">사용법</h2><p>Redis 는 key-value 데이터 구조로 간단하게 데이터를 다룰 수 있다.</p><p>데이터 입력, 수정, 삭제, 조회에 대해 아래와 같은 명령어를 제공한다.</p><div class="table-wrapper"><table><thead><tr><th>종류<th>역할<tbody><tr><td>set<td>데이터 저장<tr><td>get<td>데이터 조회<tr><td>rename<td>저장된 key 를 다른 이름을 가진 key 로 변경<tr><td>randomkey<td>저장된 key 중에서 하나의 임의의 key 를 조회<tr><td>keys<td>저장된 모든 key 를 검색<tr><td>exists<td>검색 대상 key 의 존재 여부 확인<tr><td>mset<td>여러 개의 데이터 저장<tr><td>mget<td>여러 개의 데이터 조회</table></div><p>redis 의 명령어를 cli 환경에서 사용하는 예시는 아래와 같다.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>redis&gt; SET num 42
<span class="s2">"OK"</span>
redis&gt; GET num
<span class="s2">"42"</span>
redis&gt; RENAME num wow
<span class="s2">"OK"</span>
redis&gt; GET wow
<span class="s2">"42"</span>
</pre></table></code></div></div><h2 id="memcached-와-차이">Memcached 와 차이</h2><p>Memcached도 key-value 모델을 기반으로 하는 NoSQL 이다. 다만 Redis가 Memcached보다 더 많은 기능을 지원하고 있다.</p><h3 id="memcached-의-장점">Memcached 의 장점</h3><ol><li>정적 데이터 캐싱에 효과적이다.<ul><li>HTML 과 같은 정적 데이터를 캐싱할 때 효율적이다.<li>metadata 에 적은 자원을 사용하기 때문에 단순한 내부 메모리 관리에는 효율이 좋다.</ul><li>멀티 스레드 지원<ul><li>컴퓨팅 자원을 추가함으로써 스케일 업이 가능하다.</ul></ol><h3 id="redis-를-사용하는-이유">Redis 를 사용하는 이유?</h3><p>Memcached 대신 Redis 를 주로 사용하는 이유는 아래와 같이 정리할 수 있다.</p><ol><li>다양한 자료구조 및 용량 지원<ul><li>Memcached 는 key 이름을 250byte 까지 제한하고, 자료구조는 string 만 사용한다.<li>Redis 는 key, value 의 이름을 512MB 까지 지원하고, hash, set, list 등 다양한 자료구조를 지원하기 때문에 데이터 조작이 편리하다.</ul><li>다양한 삭제(eviction) 정책 지원<ul><li>캐시는 메모리에 오래된 데이터를 삭제해서 새로운 데이터 공간을 확보하는 data eviction 방식을 사용한다.<li>Memcached 는 LRU(Least Recently Used) 알고리즘을 사용하기 때문에 새로운 데이터와 크기가 비슷한 데이터를 임의로 제거한다.<li>Redis 는 사용자가 6가지 다른 데이터 삭제 정책을 선택할 수 있으며, 메모리 관리와 데이터 삭제 선택을 더욱 정교하게 다룰 수 있다.</ul><li>디스크 영속화(persistence) 지원<ul><li>Redis 는 디스크(HDD)에 데이터를 영구적으로 저장할 수 있다.<li>그래서 Redis 의 데이터들은 서버 충돌이나 재부팅 시에도 복구될 수 있다는 장점이 있다.</ul><li>복제(replication) 지원<ul><li>Redis 는 동일한 데이터를 같은 물리 서버의 다른 포트 번호를 사용하는 복제본을 만들거나, 물리적으로 다른 장치에 복제할 수 있다. (데이터 이중화)<li>마스터 노드가 정상적으로 작동하지 않는 경우 레플리카(복제본)을 마스터 노드로 변경하여 서비스를 지속적으로 운영할 수 있다. 이를 Redis Sentinel 이 담당한다.</ul><li>트랜잭션(transaction) 지원<ul><li>Memcached 도 처리가 모두 성공하거나 모두 실패하는 원자성을 보장하지만, Redis 는 트랜잭션을 지원한다. 즉, 트랜잭션의 4가지 특성 ACID 를 모두 보장한다는 것이다.</ul></ol><h1 id="wordpress와-연동하기">WordPress와 연동하기</h1><p>Redis를 WordPress에 연동함으로써 웹 페이지 로딩 속도를 향상시킬 수 있다.</p><p><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-src="/assets/images/2023/2023-10-03-about-redis/3.png" alt="3.png" /></p><p>출처: <a href="https://happist.com/574008/%EC%9B%8C%EB%93%9C%ED%94%84%EB%A0%88%EC%8A%A4-%EC%98%A4%EB%B8%8C%EC%A0%9D%ED%8A%B8-%EC%BA%90%EC%8B%9C-%EC%A0%81%EC%9A%A9%EB%B2%95">워드프레스 속도 개선을 위한 오브젝트 캐시 적용법</a> [꿈꾸는섬]</p><p>WordPress를 이용할 때 사용하는 캐시는 크게 브라우저 캐시, 페이지 캐시, 오브젝트 캐시가 존재한다.</p><ul><li>브라우저 캐시 : 사용자의 브라우저에 저장하는 캐시이다. 브라우저는 방문했던 사이트의 데이터를 브라우저 캐시에 저장하기 때문에 다시 방문했을 때 빠른 속도로 페이지를 불러올 수 있다.<li>페이지 캐시 : 웹 서버(Nginx)는 사용자가 요청했던 페이지 정보를 저장하고, 다른 사용자가 해당 페이지를 요청하면 저장했던 정보를 바로 보여준다.<li>오브젝트 캐시 : 페이지를 동적으로 생성(마이 페이지 등)하기 위해 PHP에서 데이터베이스를 접속한다. 데이터베이스에 접속한다는 것은 하드디스크에 접근한다는 의미인데, Redis를 이용하면 하드디스크가 아닌 메모리에서 필요한 데이터를 빠르게 제공할 수 있다.</ul><p>Redis는 사용자의 정보 뿐만 아니라 HTML 페이지도 캐싱하기 때문에 더욱 빠른 속도로 페이지를 제공할 수 있다는 장점이 있다.</p><p>Redis를 사용하는 웹 사이트는 평균 10%~30% 정도 빠르게 페이지를 불러온다는 결과가 있다. (출처: <a href="https://www.greengeeks.com/tutorials/redis-wordpress/">GreenGeeks</a>)</p><h2 id="docker-이용해서-redis-설치하기">Docker 이용해서 Redis 설치하기</h2><p>이번 글에서는 Dockerhub 에서 이미 만들어진 이미지가 아닌 직접 만든 이미지로 설치하고자 한다.</p><h3 id="docker-composeyml">docker-compose.yml</h3><p>아래는 docker-compose.yml 파일의 내용이다.</p><div class="language-yaml highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
</pre><td class="rouge-code"><pre><span class="na">version</span><span class="pi">:</span> <span class="s2">"</span><span class="s">3"</span>

<span class="na">services</span><span class="pi">:</span>
  <span class="na">nginx</span><span class="pi">:</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">nginx</span>
    <span class="na">build</span><span class="pi">:</span> <span class="s">./requirements/nginx</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">nginx</span>
    <span class="na">ports</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">443:443</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">on-failure:3</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">wordpress_data:/var/www/html/wordpress</span>
    <span class="na">networks</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">my_server</span>

  <span class="na">mariadb</span><span class="pi">:</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">mariadb</span>
    <span class="na">build</span><span class="pi">:</span> <span class="s">./requirements/mariadb</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">mariadb</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">on-failure:3</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">mariadb_data:/var/lib/mysql</span>
    <span class="na">networks</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">my_server</span>
    <span class="na">env_file</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">.env</span>

  <span class="na">wordpress</span><span class="pi">:</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">wordpress</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">wordpress</span>
    <span class="na">depends_on</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">mariadb</span>
    <span class="na">build</span><span class="pi">:</span> <span class="s">./requirements/wordpress</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">on-failure:3</span>
    <span class="na">volumes</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">wordpress_data:/var/www/html/wordpress</span>
    <span class="na">networks</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">my_server</span>
    <span class="na">env_file</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">.env</span>

  <span class="na">redis</span><span class="pi">:</span>
    <span class="na">container_name</span><span class="pi">:</span> <span class="s">redis</span>
    <span class="na">image</span><span class="pi">:</span> <span class="s">redis</span>
    <span class="na">depends_on</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">wordpress</span>
    <span class="na">build</span><span class="pi">:</span> <span class="s">./requirements/bonus/redis</span>
    <span class="na">restart</span><span class="pi">:</span> <span class="s">on-failure:3</span>
    <span class="na">networks</span><span class="pi">:</span>
      <span class="pi">-</span> <span class="s">my_server</span>

<span class="na">volumes</span><span class="pi">:</span>
  <span class="na">wordpress_data</span><span class="pi">:</span>
    <span class="na">driver</span><span class="pi">:</span> <span class="s">local</span>
    <span class="na">driver_opts</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">none</span>
      <span class="na">device</span><span class="pi">:</span> <span class="s">/Users/joonhan/data/wordpress</span>
      <span class="na">o</span><span class="pi">:</span> <span class="s">bind</span>
  <span class="na">mariadb_data</span><span class="pi">:</span>
    <span class="na">driver</span><span class="pi">:</span> <span class="s">local</span> <span class="c1"># Save in host OS (Available for other volume plugin)</span>
    <span class="na">driver_opts</span><span class="pi">:</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">none</span> <span class="c1"># File system type (like tmpfs, shm, ramfs)</span>
      <span class="na">device</span><span class="pi">:</span> <span class="s">/Users/joonhan/data/mysql</span>
      <span class="na">o</span><span class="pi">:</span> <span class="s">bind</span>

<span class="na">networks</span><span class="pi">:</span>
  <span class="na">my_server</span><span class="pi">:</span>
    <span class="na">driver</span><span class="pi">:</span> <span class="s">bridge</span>
</pre></table></code></div></div><h3 id="redis-dockerfile">Redis Dockerfile</h3><p>아래는 Redis의 Dockerfile 이다.</p><div class="language-docker highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre><span class="c"># Base image</span>
<span class="k">FROM</span><span class="s"> alpine:3.16</span>

<span class="k">RUN </span>apk update

<span class="k">RUN </span>apk add <span class="nt">--no-cache</span> dumb-init redis

<span class="c"># Set memory usage limit and data eviction policy</span>
<span class="k">RUN </span><span class="nb">echo</span> <span class="s2">"maxmemory 100mb"</span> <span class="o">&gt;&gt;</span> /etc/redis.conf
<span class="k">RUN </span><span class="nb">echo</span> <span class="s2">"maxmemory-policy allkeys-lru"</span> <span class="o">&gt;&gt;</span> /etc/redis.conf

<span class="c"># Expose port 6379</span>
<span class="k">EXPOSE</span><span class="s"> 6379</span>

<span class="c"># Start dumb-init for PID 1</span>
<span class="k">ENTRYPOINT</span><span class="s"> ["/usr/bin/dumb-init", "--"]</span>

<span class="k">CMD</span><span class="s"> ["redis-server", "--protected-mode", "no"]</span>
</pre></table></code></div></div><p><strong>maxmemory 및 data eviction 정책 설정</strong></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="c"># Set memory usage limit and data eviction policy</span>
RUN <span class="nb">echo</span> <span class="s2">"maxmemory 100mb"</span> <span class="o">&gt;&gt;</span> /etc/redis.conf
RUN <span class="nb">echo</span> <span class="s2">"maxmemory-policy allkeys-lru"</span> <span class="o">&gt;&gt;</span> /etc/redis.conf
</pre></table></code></div></div><p>redis 는 데이터를 메모리(RAM)에 저장하기 때문에 하드디스크에 비해 적은 데이터를 저장할 수 있다.</p><p>그렇기 때문에 악의적인 의도를 가진 클라이언트가 메모리를 과도하게 많이 사용하는 것을 방지하기 위해 최대 메모리 사용량을 <code class="language-plaintext highlighter-rouge">maxmemory</code> directive 를 이용해서 설정할 수 있다.</p><p>또한, 데이터가 메모리가 아닌 swap 영역에 저장되지 않도록 방지하기 위해 사용할 수 있다.</p><p><code class="language-plaintext highlighter-rouge">maxmemory</code> 의 최대 한도는 정해져 있지 않다.</p><p>그래서 물리적인 메모리 용량 이상을 사용하면 하드디스크에 존재하는 swap 영역으로 옮겨진다. 하드디스크에 접근하는 속도는 메모리에 접근하는 속도보다 느리기 때문에 swap 영역까지 사용하는 것은 redis 를 사용하는 목적에 부합하지 않다.</p><p>따라서 <code class="language-plaintext highlighter-rouge">maxmemory</code> 를 설정하여 빠른 데이터 제공을 보장해주는 것이 바람직하다.</p><p>그리고 메모리의 데이터를 지울 때 어떤 방식으로 지울 것(data eviction)인지 설정할 수 있다.</p><p><code class="language-plaintext highlighter-rouge">maxmemory</code> 가 설정되고, 별도의 정책을 설정하지 않았다면 <code class="language-plaintext highlighter-rouge">maxmemory</code> 에 도달하는 순간 오류를 발생시킨다.</p><p>다양한 종류가 있지만 여기서는 최근에 가장 적게 쓰인 데이터를 삭제하는 LRU(Least Recently Used) 알고리즘을 설정했다.</p><p>자세한 내용은 <a href="https://redis.io/docs/reference/eviction/">redis 공식 홈페이지</a>에서 확인 가능하다.</p><p><strong>redis protected mode</strong></p><p>CMD 명령어에 인자로 <code class="language-plaintext highlighter-rouge">--protected-mode no</code> 가 입력된 것을 확인할 수 있다.</p><p>redis 3.2.0 버전부터 protected mode 는 무분별한 공격을 막기 위해 도입되었다.</p><p>redis도 소켓을 이용한 통신을 하기 때문에 IP 주소와 redis 가 사용하는 포트 번호를 알면 누구든 접속해서 데이터를 확인할 수 있다.</p><p>이러한 문제를 막기 위해 Redis 는 기본 설정을 사용하는데 비밀번호를 설정하지 않은 경우 protected mode 를 사용하도록 설정했다.</p><p>이 모드는 외부의 접속 시도를 막고, 오직 루프백(자기 자신)만 접속을 허용한다.</p><p>현재 구성한 컨테이너 환경은 redis 가 WordPress 컨테이너와 다른 컨테이너를 사용하고 있다.</p><p>즉, redis 컨테이너와 WordPress 컨테이너는 다른 IP 주소를 가지고 있기 때문에 WordPress 에서 redis 로 접속을 시도하려고 해도 아래와 같은 오류 메세지를 표시한다.</p><blockquote><p><code class="language-plaintext highlighter-rouge">SELECT</code> failed: DENIED Redis is running in protected mode because protected mode is enabled and no password is set for the default user. In this mode connections are only accepted from the loopback interface. If you want to connect from external computers to Redis you may adopt one of the following solutions: 1) Just disable protected mode sending the command ‘CONFIG SET protected-mode no’ from the loopback interface by connecting to Redis from the same host the server is running, however MAKE SURE Redis is not publicly accessible from internet if you do so. Use CONFIG REWRITE to make this change permanent. 2) Alternatively you can just disable the protected mode by editing the Redis configuration file, and setting the protected mode option to ‘no’, and then restarting the server. 3) If you started the server manually just for testing, restart it with the ‘–protected-mode no’ option. 4) Setup a an authentication password for the default user. NOTE: You only need to do one of the above things in order for the server to start accepting connections from the outside.</p></blockquote><p>따라서 현재 구성한 환경에서 redis 를 정상적으로 작동시키기 위해서는 protected mode 를 해제해주어야 한다.</p><h3 id="wordpress-dockerfile">WordPress Dockerfile</h3><p>WordPress 컨테이너를 위한 Dockerfile 은 아래와 같다.</p><div class="language-docker highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
</pre><td class="rouge-code"><pre><span class="c"># Base image</span>
<span class="k">FROM</span><span class="s"> alpine:3.16</span>

<span class="c"># Install necessary packages</span>

<span class="k">RUN </span>apk update

<span class="k">RUN </span>apk add <span class="nt">--no-cache</span> <span class="se">\
</span>    dumb-init <span class="se">\
</span>    curl <span class="se">\
</span>    ca-certificates

<span class="k">RUN </span>apk add <span class="nt">--no-cache</span> <span class="se">\
</span>    php-fpm <span class="se">\
</span>    php-opcache <span class="se">\
</span>    php-mysqli <span class="se">\
</span>    php-pdo_mysql <span class="se">\
</span>    php-json <span class="se">\
</span>    php-xml <span class="se">\
</span>    php-gd <span class="se">\
</span>    php-dom <span class="se">\
</span>    php-zip <span class="se">\
</span>    php-curl <span class="se">\
</span>    php-openssl <span class="se">\
</span>    php-mbstring <span class="se">\
</span>    php-ctype <span class="se">\
</span>    php-tokenizer <span class="se">\
</span>    php-simplexml <span class="se">\
</span>    php-fileinfo <span class="se">\
</span>    php-exif <span class="se">\
</span>    php-cli <span class="se">\
</span>    php-gd <span class="se">\
</span>    php-phar <span class="se">\
</span>    mariadb-client

<span class="c"># Create directories for wordpress</span>
<span class="k">RUN </span><span class="nb">mkdir</span> <span class="nt">-p</span> /var/www/html/wordpress

<span class="c"># Download wp-cli</span>
<span class="k">RUN </span>curl <span class="nt">-O</span> https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar <span class="o">&amp;&amp;</span> <span class="se">\
</span>    <span class="nb">chmod</span> +x wp-cli.phar <span class="o">&amp;&amp;</span> <span class="se">\
</span>    <span class="nb">mv </span>wp-cli.phar /usr/local/bin/wp

<span class="c"># Copy php-fpm configuration file</span>
<span class="k">COPY</span><span class="s"> ./conf/www.conf /etc/php8/php-fpm.d/</span>

<span class="k">RUN </span><span class="nb">chmod</span> +x /usr/bin/dumb-init
<span class="k">COPY</span><span class="s"> ./tools/entrypoint.sh /entrypoint.sh</span>

<span class="c"># Expose port 9000 for php-fpm</span>
<span class="k">EXPOSE</span><span class="s"> 9000</span>

<span class="k">WORKDIR</span><span class="s"> /var/www/html/wordpress</span>

<span class="c"># Start dumb-init for PID 1</span>
<span class="k">ENTRYPOINT</span><span class="s"> ["/usr/bin/dumb-init", "--"]</span>

<span class="c"># Start php-fpm in the foreground</span>
<span class="k">CMD</span><span class="s"> ["/bin/sh", "/entrypoint.sh"]</span>
</pre></table></code></div></div><p>여기서 WORKDIR 을 <code class="language-plaintext highlighter-rouge">/var/www/html/wordpress</code> 를 설정하는 이유는 이어지는 <code class="language-plaintext highlighter-rouge">entrypoint.sh</code> 파일에서 설명할 것이다.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
</pre><td class="rouge-code"><pre><span class="c">#!/bin/sh</span>

<span class="c"># Update WP-CLI to the latest stable release.</span>
wp cli update

<span class="c"># Download and extracts WordPress core files to the specified path.</span>
wp core download <span class="nt">--allow-root</span> <span class="nt">--path</span><span class="o">=</span><span class="s2">"</span><span class="nv">$WP_PATH</span><span class="s2">"</span>

<span class="c"># Generates a wp-config.php file.</span>
wp config create <span class="nt">--dbname</span><span class="o">=</span><span class="s2">"</span><span class="nv">$MARIA_DB_DATABASE</span><span class="s2">"</span> <span class="nt">--dbuser</span><span class="o">=</span><span class="s2">"</span><span class="nv">$MARIA_DB_USER</span><span class="s2">"</span> <span class="se">\</span>
				 <span class="nt">--dbpass</span><span class="o">=</span><span class="s2">"</span><span class="nv">$MARIA_DB_PASSWORD</span><span class="s2">"</span> <span class="nt">--dbhost</span><span class="o">=</span><span class="s2">"</span><span class="nv">$MARIA_DB_HOST</span><span class="s2">"</span> <span class="se">\</span>
				 <span class="nt">--path</span><span class="o">=</span><span class="s2">"</span><span class="nv">$WP_PATH</span><span class="s2">"</span> <span class="se">\</span>
				 <span class="nt">--extra-php</span> <span class="o">&lt;&lt;</span><span class="no">PHP</span><span class="sh">
define('WP_REDIS_HOST', 'redis');
define('WP_REDIS_PORT', </span><span class="k">${</span><span class="nv">REDIS_PORT</span><span class="k">}</span><span class="sh">);
</span><span class="no">PHP

</span><span class="c"># Creates the WordPress tables in the database using the URL, title, and default admin user details provided</span>
wp core <span class="nb">install</span> <span class="nt">--allow-root</span> <span class="nt">--url</span><span class="o">=</span><span class="s2">"</span><span class="nv">$WP_DOMAIN</span><span class="s2">"</span> <span class="nt">--title</span><span class="o">=</span><span class="s2">"</span><span class="nv">$WP_TITLE</span><span class="s2">"</span> <span class="se">\</span>
				<span class="nt">--admin_user</span><span class="o">=</span><span class="s2">"</span><span class="nv">$WP_ADMIN_USER</span><span class="s2">"</span> <span class="nt">--admin_password</span><span class="o">=</span><span class="s2">"</span><span class="nv">$WP_ADMIN_PWD</span><span class="s2">"</span> <span class="se">\</span>
				<span class="nt">--admin_email</span><span class="o">=</span><span class="s2">"</span><span class="nv">$WP_ADMIN_EMAIL</span><span class="s2">"</span> <span class="nt">--skip-email</span> <span class="nt">--path</span><span class="o">=</span><span class="s2">"</span><span class="nv">$WP_PATH</span><span class="s2">"</span>

<span class="c"># Creates a new user</span>
wp user create <span class="s2">"</span><span class="nv">$WP_USER</span><span class="s2">"</span> <span class="s2">"</span><span class="nv">$WP_USER_EMAIL</span><span class="s2">"</span> <span class="nt">--user_pass</span><span class="o">=</span><span class="s2">"</span><span class="nv">$WP_USER_PWD</span><span class="s2">"</span> <span class="se">\</span>
				<span class="nt">--path</span><span class="o">=</span><span class="s2">"</span><span class="nv">$WP_PATH</span><span class="s2">"</span>

<span class="c"># Install redis-cache plugin</span>
wp plugin <span class="nb">install </span>redis-cache <span class="nt">--activate</span> <span class="nt">--path</span><span class="o">=</span><span class="s2">"</span><span class="nv">$WP_PATH</span><span class="s2">"</span>

<span class="c"># Enable redis-cache plugin</span>
wp redis <span class="nb">enable</span>

<span class="c"># Set ownership of WordPress files to www-data</span>
adduser <span class="nt">-D</span> <span class="nt">-S</span> <span class="nt">-G</span> www-data www-data
<span class="nb">chown</span> <span class="nt">-R</span> www-data:www-data /var/www/html/wordpress

<span class="c"># Execute PHP FastCGI in foreground</span>
php-fpm8 <span class="nt">-F</span>
</pre></table></code></div></div><p><strong>WORDIR 을 설정하는 이유</strong></p><p><code class="language-plaintext highlighter-rouge">wp config create</code> 명령어를 사용할 때 발생하는 오류 때문에 설정했다.</p><p>2023년 5월에는 WORKDIR 을 별도로 설정하지 않아도 오류가 발생하지 않았다.</p><p>하지만, 2023년 10월에 다시 시도해보니 아래와 같은 오류 메시지가 표시됐다.</p><blockquote><p>PHP Warning: file_get_contents(phar://wp-cli.phar/vendor/wp-cli/wp-cli/templates/phar://usr/bin/wp/vendor/wp-cli/config-command/templates/wp-config.mustache): Failed to open stream: phar error: “vendor/wp-cli/wp-cli/templates/phar:/usr/bin/wp/vendor/wp-cli/config-command/templates/wp-config.mustache” is not a file in phar “wp-cli.phar” in phar:///usr/bin/wp/vendor/wp-cli/wp-cli/php/utils.php on line 605 Error: Could not create new ‘wp-config.php’ file. Error: Strange wp-config.php file: wp-settings.php is not loaded directly. Error: Strange wp-config.php file: wp-settings.php is not loaded directly.</p></blockquote><p><strong><code class="language-plaintext highlighter-rouge">wp config create</code> 사용 시 redis 관련 설정 추가</strong></p><p>—extra-php 옵션을 이용해서 redis port 와 host 이름을 지정해주었다.</p><p>host 이름은 redis 컨테이너의 이름으로 지정하면 된다.</p><p>redis port 는 .env 파일로 전달하는 환경변수 값을 입력했다.</p><p>redis 기본 포트는 6379 이지만, 보안을 높이고자 한다면 다른 포트 번호를 사용하는 것이 권장된다.</p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>wp config create <span class="nt">--dbname</span><span class="o">=</span><span class="s2">"</span><span class="nv">$MARIA_DB_DATABASE</span><span class="s2">"</span> <span class="nt">--dbuser</span><span class="o">=</span><span class="s2">"</span><span class="nv">$MARIA_DB_USER</span><span class="s2">"</span> <span class="se">\</span>
				 <span class="nt">--dbpass</span><span class="o">=</span><span class="s2">"</span><span class="nv">$MARIA_DB_PASSWORD</span><span class="s2">"</span> <span class="nt">--dbhost</span><span class="o">=</span><span class="s2">"</span><span class="nv">$MARIA_DB_HOST</span><span class="s2">"</span> <span class="se">\</span>
				 <span class="nt">--path</span><span class="o">=</span><span class="s2">"</span><span class="nv">$WP_PATH</span><span class="s2">"</span> <span class="se">\</span>
				 <span class="nt">--extra-php</span> <span class="o">&lt;&lt;</span><span class="no">PHP</span><span class="sh">
define('WP_REDIS_HOST', 'redis');
define('WP_REDIS_PORT', </span><span class="k">${</span><span class="nv">REDIS_PORT</span><span class="k">}</span><span class="sh">);
</span><span class="no">PHP
</span></pre></table></code></div></div><p><strong>wordpress ‘activate’와 ‘enable’의 차이</strong></p><div class="language-bash highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c"># Install redis-cache plugin</span>
wp plugin <span class="nb">install </span>redis-cache <span class="nt">--activate</span> <span class="nt">--path</span><span class="o">=</span><span class="s2">"</span><span class="nv">$WP_PATH</span><span class="s2">"</span>

<span class="c"># Enable redis-cache plugin</span>
wp redis <span class="nb">enable</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">wp plugin install</code> 명령어의 옵션으로 activate 를 추가했는데, 그 다음 명령어에서 <code class="language-plaintext highlighter-rouge">wp redis enable</code> 을 추가로 입력했다.</p><p>찾아보니 activate 는 WordPress 가 플러그인의 메인 스크립트를 불러오고, DB 테이블을 추가하는 등 기본 세팅을 실행하는 과정이라고 한다. (출처 : <a href="https://developer.wordpress.org/plugins/plugin-basics/activation-deactivation-hooks/">wordpress developer</a>)</p><p>enable 은 activate 된 플러그인을 사용 가능하게 만드는 명령어라고 한다.</p><p>비유로 설명하자면, 콘센트마다 전원 스위치가 있는 멀티탭이 있다고 해보자.</p><p>콘센트에 플러그를 꽂는 것 자체는 activate 에 해당하고, enable 은 꽂은 플러그를 실제로 사용할 수 있게 스위치를 키는 것에 해당한다.</p><h1 id="참고자료">참고자료</h1><ul><li><a href="https://sihyung92.oopy.io/database/redis/1">레디스Redis가 뭐에요? 레디스 설치하기, 레디스 튜토리얼</a> [sihyung92.oopy.io]<li><a href="https://seokhyun2.tistory.com/63">[Redis] Redis란? &amp; Redis 사용방법</a> [티스토리]<li><a href="https://inpa.tistory.com/entry/REDIS-%F0%9F%93%9A-%EB%8D%B0%EC%9D%B4%ED%84%B0-%ED%83%80%EC%9E%85Collection-%EC%A2%85%EB%A5%98-%EC%A0%95%EB%A6%AC">[REDIS] 📚 자료구조 명령어 종류 &amp; 활용 사례 💯 총정리</a> [티스토리]<li><a href="https://www.youtube.com/watch?v=92NizoBL4uA">[NHN FORWARD 2021] Redis 야무지게 사용하기</a> [유튜브]<li><a href="https://velog.io/@power0080/Message-Queue-%EA%B0%9C%EB%85%90-%EC%A0%95%EB%A6%AC">[개념원리]Message Queue</a> [velog]<li><a href="https://escapefromcoding.tistory.com/704">In-memory Redis vs Memcached 비교하기</a> [티스토리]<li><a href="https://mozi.tistory.com/372">[Redis] 복제 Replication 이중화 방법, 위험성, 이중화정보 확인 방법</a> [티스토리]<li><a href="https://upcurvewave.tistory.com/354">Redis의 특징, 개념, 장점, 단점, 목적</a> [티스토리]<li><a href="https://www.happykoo.net/@happykoo/posts/51">[Redis] master-slave(replication) 구축하기</a> [티스토리]<li><a href="https://chagokx2.tistory.com/102">Redis Eviction 정책을 적용하여 효율적인 캐시 띄우기</a> [티스토리]<li><a href="https://hanamon.kr/%EB%8D%B0%EC%9D%B4%ED%84%B0%EB%B2%A0%EC%9D%B4%EC%8A%A4-%ED%8A%B8%EB%9E%9C%EC%9E%AD%EC%85%98%EC%9D%98-acid-%EC%84%B1%EC%A7%88/">[데이터베이스] 트랜잭션의 ACID 성질</a> [티스토리]<li><a href="https://cloud.google.com/learn/what-is-a-relational-database?hl=ko">관계형 데이터베이스란 무엇인가요?</a> [google cloud]<li><a href="https://frozenpond.tistory.com/156">[개발상식] 메모리란(DISK IO가 느린 이유, 램이 사용되는 곳)</a> [티스토리]<li><a href="https://amanan1004.tistory.com/27">NAND, NOR flash Memory에 대해 알아보자</a> [티스토리]<li><a href="https://namu.wiki/w/%EC%86%8C%EC%9E%90">소자</a> [나무위키]<li><a href="https://namu.wiki/w/ROM">ROM</a> [나무위키]<li><a href="https://namu.wiki/w/%ED%95%98%EB%93%9C%20%EB%94%94%EC%8A%A4%ED%81%AC%20%EB%93%9C%EB%9D%BC%EC%9D%B4%EB%B8%8C">하드 디스크 드라이브</a> [나무위키]</ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/redis/'>redis</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/redis/" class="post-tag no-text-decoration">redis</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Redis 개념, 장점과 단점, Docker 사용 예시 정리 - Dev Joon&url=https://han-joon-hyeok.github.io/posts/about-redis/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Redis 개념, 장점과 단점, Docker 사용 예시 정리 - Dev Joon&u=https://han-joon-hyeok.github.io/posts/about-redis/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Redis 개념, 장점과 단점, Docker 사용 예시 정리 - Dev Joon&url=https://han-joon-hyeok.github.io/posts/about-redis/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/c-bitwise-operation-between-different-integer-sizes/">[C언어] 자료형 크기 차이로 인한 비트 연산 오류 해결 방법</a><li><a href="/posts/connect-to-ec2-without-ssh-key-using-session-manager/">[AWS] EC2 인스턴스 ssh 키 없이 터미널 접속하는 방법 (AWS Session Manager)</a><li><a href="/posts/how-to-access-geo-restricted-websites-using-mullvad-vpn/">국가 제한이 걸린 사이트에 접속하는 방법 (feat. Mullvad VPN)</a><li><a href="/posts/network-overview/">네트워크 LAN, WAN / 스위치, 라우터 / IP 주소 / 서브넷 개념 정리</a><li><a href="/posts/what-is-nat/">NAT란?</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/programmers/">programmers</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/level2/">level2</a> <a class="post-tag" href="/tags/level1/">level1</a> <a class="post-tag" href="/tags/javascript/">JavaScript</a> <a class="post-tag" href="/tags/os/">os</a> <a class="post-tag" href="/tags/pipex/">pipex</a> <a class="post-tag" href="/tags/born2beroot/">born2beroot</a> <a class="post-tag" href="/tags/git/">git</a> <a class="post-tag" href="/tags/data-structure/">Data Structure</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/c-bitwise-operation-between-different-integer-sizes/"><div class="card-body"> <span class="timeago small" > Oct 17 <i class="unloaded">2025-10-17T09:40:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[C언어] 자료형 크기 차이로 인한 비트 연산 오류 해결 방법</h3><div class="text-muted small"><p> 개요 C언어에서 서로 다른 크기를 가진 자료형을 비트 연산할 때 발생할 수 있는 문제와 해결 방법을 정리했다. 이 글은 “C언어 매크로 재정의 오류 원인과 해결 방법”의 후속 글이다. 문제 상황 AND 연산을 수행하는 매크로 함수에서, 매개변수의 자료형 크기 차이로 인해 의도치 않게 상위 32비트가 소실되는 문제가 발생했다. 1 #define...</p></div></div></a></div><div class="card"> <a href="/posts/gcc-macro-redefined-error-fix/"><div class="card-body"> <span class="timeago small" > Oct 14 <i class="unloaded">2025-10-14T14:40:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[C언어] 매크로 재정의 오류 원인과 해결 방법 (GCC 전처리기 기준)</h3><div class="text-muted small"><p> 실행 환경 OS: Ubuntu 22.04 Architecture: x86_64 (64-bit) GCC: 11.4.0 요약 동일한 이름의 매크로를 서로 다른 방식으로 정의하면 GCC 전처리기가 두 매크로를 동일하지 않은 토큰으로 판단해 redefined 오류가 발생한다. 안전하게 프로그램을 설계하려면 #ifndef 전처리기 사용 또...</p></div></div></a></div><div class="card"> <a href="/posts/google-calendar-organization-tips/"><div class="card-body"> <span class="timeago small" > Oct 5 <i class="unloaded">2025-10-05T20:35:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>생각 많은 ISTJ 개발자가 구글 캘린더를 활용하는 방법</h3><div class="text-muted small"><p> 개요 구글 캘린더로 일정과 할 일을 관리하는 방법을 정리했다. 평소에 생각이 많다보니 생각을 정리하는 나름의 체계를 갖추고자 했다. 단순히 일정을 기록하는 것이 아니라, 머릿속을 비워두기 위한 시스템으로서의 캘린더 사용법이다. 일정 관리 구글 캘린더에서는 목적에 맞는 캘린더를 생성하는 것이 가능하다. 전체 캘린더에 표시되는 블럭을 색깔로 구분할 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/next-js-env-variable-undefined-with-docker/" class="btn btn-outline-primary" prompt="Older"><p>next.js 빌드 시 환경 변수가 undefined 인 문제 해결 (feat. docker-compose)</p></a> <a href="/posts/programmers-curse-numbers/" class="btn btn-outline-primary" prompt="Newer"><p>프로그래머스 Level 0 - 저주의 숫자 3 (C++)</p></a></div><script src="https://utteranc.es/client.js" repo="Han-Joon-Hyeok/Han-Joon-Hyeok.github.io" issue-term="pathname" label="Comments" theme="preferred-color-scheme" crossorigin="anonymous" async> </script></div></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lozad/dist/lozad.min.js"></script> <script type="text/javascript"> const imgs = document.querySelectorAll('.post-content img'); const observer = lozad(imgs); observer.observe(); </script><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://github.com/han-joon-hyeok">Joon Hyeok Han</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/programmers/">programmers</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/level2/">level2</a> <a class="post-tag" href="/tags/level1/">level1</a> <a class="post-tag" href="/tags/javascript/">JavaScript</a> <a class="post-tag" href="/tags/os/">os</a> <a class="post-tag" href="/tags/pipex/">pipex</a> <a class="post-tag" href="/tags/born2beroot/">born2beroot</a> <a class="post-tag" href="/tags/git/">git</a> <a class="post-tag" href="/tags/data-structure/">Data Structure</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://han-joon-hyeok.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
