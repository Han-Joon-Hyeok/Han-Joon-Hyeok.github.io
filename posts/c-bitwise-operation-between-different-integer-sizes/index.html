<!DOCTYPE html><html lang="ko-KR" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="pv-cache-enabled" content="false"><meta name="generator" content="Jekyll v4.3.0" /><meta property="og:title" content="[C언어] 자료형 크기 차이로 인한 비트 연산 오류 해결 방법" /><meta name="author" content="Joon Hyeok Han" /><meta property="og:locale" content="ko_KR" /><meta name="description" content="개요" /><meta property="og:description" content="개요" /><link rel="canonical" href="https://han-joon-hyeok.github.io/posts/c-bitwise-operation-between-different-integer-sizes/" /><meta property="og:url" content="https://han-joon-hyeok.github.io/posts/c-bitwise-operation-between-different-integer-sizes/" /><meta property="og:site_name" content="Dev Joon" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-10-17T09:40:00+09:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="[C언어] 자료형 크기 차이로 인한 비트 연산 오류 해결 방법" /><meta name="twitter:site" content="@" /><meta name="twitter:creator" content="@Joon Hyeok Han" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Joon Hyeok Han"},"dateModified":"2025-10-26T19:56:54+09:00","datePublished":"2025-10-17T09:40:00+09:00","description":"개요","headline":"[C언어] 자료형 크기 차이로 인한 비트 연산 오류 해결 방법","mainEntityOfPage":{"@type":"WebPage","@id":"https://han-joon-hyeok.github.io/posts/c-bitwise-operation-between-different-integer-sizes/"},"url":"https://han-joon-hyeok.github.io/posts/c-bitwise-operation-between-different-integer-sizes/"}</script><title>[C언어] 자료형 크기 차이로 인한 비트 연산 오류 해결 방법 | Dev Joon</title><link rel="shortcut icon" href="/assets/images/favicons/favicon.ico" type="image/x-icon"><link rel="icon" href="/assets/images/favicons/favicon.ico" type="image/x-icon"><link rel="apple-touch-icon" href="/assets/images/favicons/apple-icon.png"><link rel="apple-touch-icon" href="/assets/images/favicons/apple-icon-precomposed.png"><link rel="apple-touch-icon" sizes="57x57" href="/assets/images/favicons/apple-icon-57x57.png"><link rel="apple-touch-icon" sizes="60x60" href="/assets/images/favicons/apple-icon-60x60.png"><link rel="apple-touch-icon" sizes="72x72" href="/assets/images/favicons/apple-icon-72x72.png"><link rel="apple-touch-icon" sizes="76x76" href="/assets/images/favicons/apple-icon-76x76.png"><link rel="apple-touch-icon" sizes="114x114" href="/assets/images/favicons/apple-icon-114x114.png"><link rel="apple-touch-icon" sizes="120x120" href="/assets/images/favicons/apple-icon-120x120.png"><link rel="apple-touch-icon" sizes="144x144" href="/assets/images/favicons/apple-icon-144x144.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/images/favicons/apple-icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/images/favicons/apple-icon-180x180.png"><link rel="icon" type="image/png" sizes="192x192" href="/assets/images/favicons/android-icon-192x192.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/images/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="96x96" href="/assets/images/favicons/favicon-96x96.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/images/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/images/favicons/manifest.json"><meta name='msapplication-config' content='/assets/images/favicons/browserconfig.xml'><meta name="msapplication-TileColor" content="#ffffff"><meta name="msapplication-TileImage" content="/assets/images/favicons/ms-icon-144x144.png"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="cdn.jsdelivr.net"><link rel="dns-prefetch" href="cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css" integrity="sha256-LA89z+k9fjgMKQ/kq4OO2Mrf8VltYml/VES+Rg0fh20=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css" integrity="sha256-+N4/V/SbAFiW1MPBCXnfnP9QSN3+Keu+NlB+0ev/YKQ=" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-SKST7KNWSJ"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-SKST7KNWSJ'); }); </script> <script type="text/x-mathjax-config"> MathJax.Hub.Config({tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}}); </script> <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"> </script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/images/profile.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Dev Joon</a></div><div class="site-subtitle font-italic">성장하는 개발자, 한준혁입니다.</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/Han-Joon-Hyeok" aria-label="github" class="order-3" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://www.linkedin.com/in/" aria-label="linkedin" class="order-4" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['joonhyeok.han','gmail.com'].join('@')" aria-label="email" class="order-5" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" class="order-6" > <i class="fas fa-rss"></i> </a> <span class="icon-border order-2"></span> <span id="mode-toggle-wrapper" class="order-1"> <i class="mode-toggle fas fa-adjust"></i> <script type="text/javascript"> class ModeToggle { static get MODE_KEY() { return "mode"; } static get DARK_MODE() { return "dark"; } static get LIGHT_MODE() { return "light"; } constructor() { if (this.hasMode) { if (this.isDarkMode) { if (!this.isSysDarkPrefer) { this.setDark(); } } else { if (this.isSysDarkPrefer) { this.setLight(); } } } var self = this; /* always follow the system prefers */ this.sysDarkPrefers.addListener(function() { if (self.hasMode) { if (self.isDarkMode) { if (!self.isSysDarkPrefer) { self.setDark(); } } else { if (self.isSysDarkPrefer) { self.setLight(); } } self.clearMode(); } self.updateMermaid(); }); } /* constructor() */ setDark() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.DARK_MODE); } setLight() { $('html').attr(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); sessionStorage.setItem(ModeToggle.MODE_KEY, ModeToggle.LIGHT_MODE); } clearMode() { $('html').removeAttr(ModeToggle.MODE_KEY); sessionStorage.removeItem(ModeToggle.MODE_KEY); } get sysDarkPrefers() { return window.matchMedia("(prefers-color-scheme: dark)"); } get isSysDarkPrefer() { return this.sysDarkPrefers.matches; } get isDarkMode() { return this.mode == ModeToggle.DARK_MODE; } get isLightMode() { return this.mode == ModeToggle.LIGHT_MODE; } get hasMode() { return this.mode != null; } get mode() { return sessionStorage.getItem(ModeToggle.MODE_KEY); } /* get the current mode on screen */ get modeStatus() { if (this.isDarkMode || (!this.hasMode && this.isSysDarkPrefer) ) { return ModeToggle.DARK_MODE; } else { return ModeToggle.LIGHT_MODE; } } updateMermaid() { if (typeof mermaid !== "undefined") { let expectedTheme = (this.modeStatus === ModeToggle.DARK_MODE? "dark" : "default"); let config = { theme: expectedTheme }; /* re-render the SVG › <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function() { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } flipMode() { if (this.hasMode) { if (this.isSysDarkPrefer) { if (this.isLightMode) { this.clearMode(); } else { this.setLight(); } } else { if (this.isDarkMode) { this.clearMode(); } else { this.setDark(); } } } else { if (this.isSysDarkPrefer) { this.setLight(); } else { this.setDark(); } } this.updateMermaid(); } /* flipMode() */ } /* ModeToggle */ let toggle = new ModeToggle(); $(".mode-toggle").click(function() { toggle.flipMode(); }); </script> </span></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>[C언어] 자료형 크기 차이로 인한 비트 연산 오류 해결 방법</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>[C언어] 자료형 크기 차이로 인한 비트 연산 오류 해결 방법</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Fri, Oct 17, 2025, 9:40 AM +0900" > Oct 17, 2025 <i class="unloaded">2025-10-17T09:40:00+09:00</i> </span> by <span class="author"> Joon Hyeok Han </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Oct 26, 2025, 7:56 PM +0900" > Oct 26, 2025 <i class="unloaded">2025-10-26T19:56:54+09:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1592 words">8 min</span></div></div><div class="post-content"><h1 id="개요">개요</h1><p>C언어에서 서로 다른 크기를 가진 자료형을 비트 연산할 때 발생할 수 있는 문제와 해결 방법을 정리했다.</p><p>이 글은 “<a href="https://han-joon-hyeok.github.io/posts/gcc-macro-redefined-error-fix">C언어 매크로 재정의 오류 원인과 해결 방법</a>”의 후속 글이다.</p><h1 id="문제-상황">문제 상황</h1><p>AND 연산을 수행하는 매크로 함수에서, 매개변수의 자료형 크기 차이로 인해 의도치 않게 상위 32비트가 소실되는 문제가 발생했다.</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="cp">#define AND_BIT_OPERATION(a, b) ((a) &amp;= ~(b))
</span></pre></table></code></div></div><p>이때 사용된 비트 상수는 다음과 같다. (0번째 비트는 가장 우측에 있는 비트를 의미한다.)</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="c1">// 32비트 크기 (BIT_31)</span>
<span class="cp">#define BIT_31 0x80000000
</span>
<span class="c1">// 64비트 크기</span>
<span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">data</span> <span class="o">=</span> <span class="mh">0xFFFFFFFFFFFFFFFFULL</span><span class="p">;</span>
</pre></table></code></div></div><ul><li><code class="language-plaintext highlighter-rouge">BIT_31</code>: 32비트 정수형의 최상위 비트(31번째 비트)가 1인 수<li><code class="language-plaintext highlighter-rouge">data</code>: 64비트 정수형의 최상위 비트(63번째 비트)가 1인 수</ul><p>다음은 64비트 변수 <code class="language-plaintext highlighter-rouge">data</code>에서 특정 비트를 제거하려는 예시 코드이다.</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span>
<span class="cp">#define BIT_31 0x80000000
#define AND_BIT_OPERATION(a, b) ((a) &amp;= ~(b))
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">data</span> <span class="o">=</span> <span class="mh">0xFFFFFFFFFFFFFFFFULL</span><span class="p">;</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">"BIT_31 제거 전: 0x%016llX</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">data</span><span class="p">);</span>

    <span class="n">AND_BIT_OPERATION</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">BIT_31</span><span class="p">);</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">"BIT_31 제거 결과 : 0x%016llX</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">data</span><span class="p">);</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="코드-해석">코드 해석</h2><p><code class="language-plaintext highlighter-rouge">data</code> 변수는 64비트 크기의 자료형이며, 전체 64개 비트가 모두 1인 (<code class="language-plaintext highlighter-rouge">0xFFFFFFFFFFFFFFFF</code>)이다. 반면 <code class="language-plaintext highlighter-rouge">BIT_31</code>은 32비트 크기의 정수 상수이며, 전체 32비트 중 <strong>맨 왼쪽(31번째)</strong> 비트만 1인 수이다. 비트를 시각적으로 표현하면 다음과 같다.</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="mi">1111</span> <span class="mi">1111</span> <span class="o">/</span> <span class="mi">1111</span> <span class="mi">1111</span> <span class="o">/</span> <span class="p">...</span> <span class="o">/</span> <span class="mi">1111</span> <span class="mi">1111</span> <span class="mi">1111</span> <span class="mi">1111</span> <span class="c1">// data 변수</span>
<span class="mo">0000</span> <span class="mo">0000</span> <span class="o">/</span> <span class="mo">0000</span> <span class="mo">0000</span> <span class="o">/</span> <span class="p">...</span> <span class="o">/</span> <span class="mi">1000</span> <span class="mo">0000</span> <span class="mo">0000</span> <span class="mo">0000</span> <span class="c1">// BIT_31 변수</span>
</pre></table></code></div></div><h2 id="기대했던-결과">기대했던 결과</h2><p><code class="language-plaintext highlighter-rouge">AND_BIT_OPERATION(data, BIT_31)</code>은 내부적으로 다음 연산을 수행한다.</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">&amp;</span> <span class="p">(</span><span class="o">~</span><span class="n">BIT_31</span><span class="p">);</span>
</pre></table></code></div></div><p>이 연산의 의도는 <strong>BIT_31 위치의 비트만 0으로 만들고, 나머지는 그대로 유지하는 것</strong>이다.</p><p>따라서 기대하는 결과는 다음과 같다.</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="mi">1111</span> <span class="mi">1111</span> <span class="o">/</span> <span class="mi">1111</span> <span class="mi">1111</span> <span class="o">/</span> <span class="p">...</span> <span class="o">/</span> <span class="mi">1111</span> <span class="mi">1111</span> <span class="mi">1111</span> <span class="mi">1111</span>   <span class="c1">// data 변수</span>
<span class="mi">1111</span> <span class="mi">1111</span> <span class="o">/</span> <span class="mi">1111</span> <span class="mi">1111</span> <span class="o">/</span> <span class="p">...</span> <span class="o">/</span> <span class="mo">0111</span> <span class="mi">1111</span> <span class="mi">1111</span> <span class="mi">1111</span>   <span class="c1">// ~BIT_31 변수</span>
<span class="o">&amp;=</span>
<span class="mi">1111</span> <span class="mi">1111</span> <span class="o">/</span> <span class="mi">1111</span> <span class="mi">1111</span> <span class="o">/</span> <span class="p">...</span> <span class="o">/</span> <span class="mo">0111</span> <span class="mi">1111</span> <span class="mi">1111</span> <span class="mi">1111</span>   <span class="c1">// 기대 결과</span>
</pre></table></code></div></div><p>즉, 결과값은 <code class="language-plaintext highlighter-rouge">0xFFFFFFFF7FFFFFFF</code>이 되어야 한다.</p><h2 id="실제-결과">실제 결과</h2><p>하지만 실제 출력 결과는 다음과 같았다.</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">BIT_31</span> <span class="err">제거</span> <span class="err">전</span> <span class="o">:</span> <span class="mh">0xFFFFFFFFFFFFFFFF</span>
<span class="n">BIT_31</span> <span class="err">제거</span> <span class="err">후</span> <span class="o">:</span> <span class="mh">0x000000007FFFFFFF</span>
</pre></table></code></div></div><p>상위 32비트(FFFFFFFF00000000)가 통째로 사라진 것이다.</p><h1 id="원인-분석">원인 분석</h1><p>핵심은 연산 순서와 ‘정수 승격’(integer promotions) + ‘일반 산술 변환’(usual arithmetic conversions)이다.</p><ol><li><p><strong>단항 연산 <code class="language-plaintext highlighter-rouge">~</code>는 피연산자의 형에 먼저 적용</strong>된다.</p><p><code class="language-plaintext highlighter-rouge">b</code>가 32비트 정수(대부분 <code class="language-plaintext highlighter-rouge">unsigned int</code>)이면, <code class="language-plaintext highlighter-rouge">~b</code>는 <strong>32비트 범위에서만</strong> 보수가 계산되어 결과가 <code class="language-plaintext highlighter-rouge">0x7FFFFFFF</code>(32비트) 가 된다. 이때 <strong>상위 32비트는 존재하지 않는다.</strong></p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> <span class="mo">0111</span> <span class="mi">1111</span> <span class="mi">1111</span> <span class="mi">1111</span>   <span class="c1">// ~b 변수(0x7FFFFFFF)</span>
</pre></table></code></div></div><li><p>그 다음 <code class="language-plaintext highlighter-rouge">&amp;</code> 연산을 위해 <strong>피연산자들의 형을 맞추는 단계</strong>가 일어난다(usual arithmetic conversions).</p><p>왼쪽 피연산자 <code class="language-plaintext highlighter-rouge">a</code>는 <code class="language-plaintext highlighter-rouge">unsigned long long</code>(64비트), 오른쪽 피연산자 <code class="language-plaintext highlighter-rouge">~b</code>는 32비트입니다. 따라서 <code class="language-plaintext highlighter-rouge">~b</code>가 <strong>64비트로 승격</strong>되는데, 이 값은 (unsigned이므로) <strong>상위 32비트가 0으로 채워진 채</strong> 64비트가 된다.</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre> <span class="mo">00000000</span> <span class="mo">00000000</span> <span class="mo">00000000</span> <span class="mo">00000000</span> <span class="mo">01111111</span> <span class="mi">1111111</span> <span class="mi">1111111</span> <span class="mi">1111111</span>   <span class="c1">// 64비트 승격 시 상위 32비트 0</span>
</pre></table></code></div></div><li><p>결과적으로 <code class="language-plaintext highlighter-rouge">a &amp; (~b)</code>는 <strong>상위 32비트가 0인 마스크</strong>와 AND 되는 형태가 되어, <code class="language-plaintext highlighter-rouge">a</code>의 <strong>상위 32비트가 전부 0으로 소거</strong>된다.</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre> <span class="n">a</span><span class="p">(</span><span class="mi">64</span><span class="n">bit</span><span class="p">)</span>  <span class="o">=</span> <span class="mi">11111111</span> <span class="mi">11111111</span> <span class="mi">11111111</span> <span class="mi">11111111</span> <span class="mi">11111111</span> <span class="mi">11111111</span> <span class="mi">11111111</span> <span class="mi">11111111</span>
 <span class="err">승격된</span> <span class="o">~</span><span class="n">b</span>  <span class="o">=</span> <span class="mo">00000000</span> <span class="mo">00000000</span> <span class="mo">00000000</span> <span class="mo">00000000</span> <span class="mo">01111111</span> <span class="mi">11111111</span> <span class="mi">11111111</span> <span class="mi">11111111</span>   <span class="c1">// 64비트 승격 시 상위 32비트 0</span>
 <span class="o">------------------------------------------------</span> <span class="n">AND</span>
 <span class="err">결과</span>      <span class="o">=</span> <span class="mo">00000000</span> <span class="mo">00000000</span> <span class="mo">00000000</span> <span class="mo">00000000</span> <span class="mo">01111111</span> <span class="mi">11111111</span> <span class="mi">11111111</span> <span class="mi">11111111</span>   <span class="c1">// 상위 32비트가 0으로 소거</span>
</pre></table></code></div></div></ol><p>즉, <code class="language-plaintext highlighter-rouge">a</code>의 상위 32비트는 <strong>남아 있어야 했지만</strong>, <code class="language-plaintext highlighter-rouge">~b</code>가 <strong>32비트에서 먼저 계산</strong>된 뒤 <strong>64비트로 승격될 때 상위가 0으로 채워져</strong> AND 마스크의 상위가 모두 0이 되어버렸고, 그 결과 <code class="language-plaintext highlighter-rouge">a</code>의 상위 32비트 정보가 사라졌다.</p><p>정수 승격과 관련해서 <a href="https://www.dii.uchile.cl/~daespino/files/Iso_C_1999_definition.pdf">C99 표준</a>(ISO/IEC 9899:1999)은 일반 산술 변환에서 피연산자 간 형을 맞추는 원칙을 다음과 같이 규정한다.</p><blockquote><p>Otherwise, if both operands have signed integer types or both have unsigned integer types, the operand with the type of lesser integer conversion rank is converted to the type of the operand with greater rank.</p><p>—<em>ISO/IEC 9899:1999, 6.3.1.8 Usual arithmetic conversions</em></p></blockquote><p>즉, 위 규정에 따라 <code class="language-plaintext highlighter-rouge">a</code>가 <code class="language-plaintext highlighter-rouge">unsigned long long</code>(더 높은 rank), <code class="language-plaintext highlighter-rouge">~b</code>가 32비트 정수(더 낮은 rank)라면, <code class="language-plaintext highlighter-rouge">~b</code>는 <strong><code class="language-plaintext highlighter-rouge">a</code>의 형으로 변환</strong>된다. <code class="language-plaintext highlighter-rouge">~b</code>가 <strong>32비트에서 먼저 계산된 후</strong> 64비트로 확장되므로, 확장 시 상위 32비트는 <strong>0으로 채워진 값</strong>이 된다. 따라서 최종 AND 마스크의 상위 32비트가 0이 되어 <code class="language-plaintext highlighter-rouge">a</code>의 상위 32비트가 모두 0으로 떨어진다.</p><h1 id="문제-해결">문제 해결</h1><p>자료형 크기를 일치시키면 문제를 해결할 수 있다. 즉, 매크로 연산 과정에서 <code class="language-plaintext highlighter-rouge">b</code> 를 <code class="language-plaintext highlighter-rouge">a</code> 와 동일한 자료형으로 변환하면 된다.</p><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="cp">#define AND_BIT_OPERATION(a, b) ((a) &amp;= (~((typeof(a))b)))
</span></pre></table></code></div></div><ol><li><strong><code class="language-plaintext highlighter-rouge">(typeof(a)) (b)</code></strong>: <code class="language-plaintext highlighter-rouge">b</code>를 먼저 <strong>a와 동일한 형(너비/부호)</strong> 으로 변환한다.<li><strong><code class="language-plaintext highlighter-rouge">~((typeof(a)) (b))</code></strong>: 이제 <code class="language-plaintext highlighter-rouge">~</code>가 <strong>a와 같은 너비</strong>에서 수행된다. 즉, 64비트 <code class="language-plaintext highlighter-rouge">a</code>라면 64비트 전체에 1이 “퍼진” 보수가 만들어진다.<ul><li>예: <code class="language-plaintext highlighter-rouge">~((unsigned long long)BIT_31) == 0xFFFFFFFF7FFFFFFFULL</code></ul><li>마지막으로 <code class="language-plaintext highlighter-rouge">a &amp; (64비트)</code>가 되어, <strong>지우고 싶은 비트만 정확히 0</strong>이 되고 상위 32비트는 그대로 유지된다.</ol><h2 id="수정된-코드">수정된 코드</h2><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="cp">#include</span> <span class="cpf">&lt;stdio.h&gt;</span><span class="cp">
</span>
<span class="cp">#define BIT_31 0x80000000
#define AND_BIT_OPERATION(a, b) ((a) &amp;= (~((typeof(a))b)))
</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">data</span> <span class="o">=</span> <span class="mh">0xFFFFFFFFFFFFFFFFULL</span><span class="p">;</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">"BIT_31 제거 전 : 0x%016llX</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">data</span><span class="p">);</span>

    <span class="n">AND_BIT_OPERATION</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">BIT_31</span><span class="p">);</span>

    <span class="n">printf</span><span class="p">(</span><span class="s">"BIT_31 제거 후 : 0x%016llX</span><span class="se">\n</span><span class="s">"</span><span class="p">,</span> <span class="n">data</span><span class="p">);</span>

    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></table></code></div></div><h2 id="수정-후-결과">수정 후 결과</h2><div class="language-c highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="n">BIT_31</span> <span class="err">제거</span> <span class="err">전</span> <span class="o">:</span> <span class="mh">0xFFFFFFFFFFFFFFFF</span>
<span class="n">BIT_31</span> <span class="err">제거</span> <span class="err">후</span> <span class="o">:</span> <span class="mh">0xFFFFFFFF7FFFFFFF</span>
</pre></table></code></div></div><h1 id="참고자료">참고자료</h1><ul><li>https://stackoverflow.com/questions/12081502/typeof-operator-in-c<li><a href="https://www.dii.uchile.cl/~daespino/files/Iso_C_1999_definition.pdf">ISO/IEC 9899:1999</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/c/'>c</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=[C언어] 자료형 크기 차이로 인한 비트 연산 오류 해결 방법 - Dev Joon&url=https://han-joon-hyeok.github.io/posts/c-bitwise-operation-between-different-integer-sizes/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=[C언어] 자료형 크기 차이로 인한 비트 연산 오류 해결 방법 - Dev Joon&u=https://han-joon-hyeok.github.io/posts/c-bitwise-operation-between-different-integer-sizes/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://han-joon-hyeok.github.io/posts/c-bitwise-operation-between-different-integer-sizes/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Nest-js-google-typescript-style-with-eslint-and-prettier/">[Nest.js] 협업을 위한 Google TyepScript Style 을 ESLint, Prettier 에 간단하게 적용하기</a><li><a href="/posts/Next-js-google-typescript-style-with-eslint-and-prettier/">[Next.js] 협업을 위한 Google TyepScript Style 을 ESLint, Prettier 에 간단하게 적용하기</a><li><a href="/posts/ubuntu-file-write-permission-denied/">[Linux] 파일 write 작업 시 PermissionError: [Errno 13] Permission denied 오류 해결</a><li><a href="/posts/what-is-arp/">ARP 개념 정리</a><li><a href="/posts/ubuntu-python-crontab-not-working/">[Linux] python 을 crontab 으로 실행하도록 했는데 실행되지 않는 이유 (feat. 상대경로, 절대경로)</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/programmers/">programmers</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/level2/">level2</a> <a class="post-tag" href="/tags/level1/">level1</a> <a class="post-tag" href="/tags/os/">os</a> <a class="post-tag" href="/tags/pipex/">pipex</a> <a class="post-tag" href="/tags/born2beroot/">born2beroot</a> <a class="post-tag" href="/tags/git/">git</a> <a class="post-tag" href="/tags/data-structure/">data structure</a> <a class="post-tag" href="/tags/docker/">docker</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/c-language-struct-pointer-data-type-casting/"><div class="card-body"> <span class="timeago small" > Aug 6, 2025 <i class="unloaded">2025-08-06T16:30:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>C언어 서로 다른 구조체 포인터 캐스팅의 원리</h3><div class="text-muted small"><p> 개요 C언어에서 서로 다른 구조체 포인터를 캐스팅할 때의 작동 원리를 정리한다. 이를 통해 C에서도 구조체 레이아웃을 이용해 객체 지향 언어의 ‘업캐스팅’과 유사한 동작을 구현할 수 있음을 확인할 수 있다. 분석 대상 코드 구조체 정의 서로 다른 멤버를 가진 구조체가 있다고 하자. typedef struct parent_s { str...</p></div></div></a></div><div class="card"> <a href="/posts/gcc-macro-redefined-error-fix/"><div class="card-body"> <span class="timeago small" > Oct 14, 2025 <i class="unloaded">2025-10-14T14:40:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>[C언어] 매크로 재정의 오류 원인과 해결 방법 (GCC 전처리기 기준)</h3><div class="text-muted small"><p> 실행 환경 OS: Ubuntu 22.04 Architecture: x86_64 (64-bit) GCC: 11.4.0 요약 동일한 이름의 매크로를 서로 다른 방식으로 정의하면 GCC 전처리기가 두 매크로를 동일하지 않은 토큰으로 판단해 redefined 오류가 발생한다. 안전하게 프로그램을 설계하려면 #ifndef 전처리기 사용 또...</p></div></div></a></div><div class="card"> <a href="/posts/static-variable-in-c/"><div class="card-body"> <span class="timeago small" > Jun 14, 2022 <i class="unloaded">2022-06-14T16:09:00+09:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>정적 변수(static variable)란?</h3><div class="text-muted small"><p> 정적 변수(static variable) 정적 변수는 프로그램이 실행되는 동안 계속 유지되는 변수이다. 지역 변수는 함수가 실행되는 동안 해당 스코프 안에서만 생성되고, 함수가 끝나면 파괴되는데, 이와 달리 정적 변수는 함수가 끝나도 값이 그대로 유지된다. 정적 변수를 선언하는 방법은 다음과 같다. static 자료형 변수명; 정적 변수의 ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/gcc-macro-redefined-error-fix/" class="btn btn-outline-primary" prompt="Older"><p>[C언어] 매크로 재정의 오류 원인과 해결 방법 (GCC 전처리기 기준)</p></a> <a href="/posts/understanding-of-typeof-in-c/" class="btn btn-outline-primary" prompt="Newer"><p>[C] typeof 개념 정리 (GNU 확장형 타입 추론)</p></a></div><script src="https://utteranc.es/client.js" repo="Han-Joon-Hyeok/Han-Joon-Hyeok.github.io" issue-term="pathname" label="Comments" theme="preferred-color-scheme" crossorigin="anonymous" async> </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2026 <a href="https://github.com/han-joon-hyeok">Joon Hyeok Han</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-xl-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/programmers/">programmers</a> <a class="post-tag" href="/tags/javascript/">javascript</a> <a class="post-tag" href="/tags/level2/">level2</a> <a class="post-tag" href="/tags/level1/">level1</a> <a class="post-tag" href="/tags/os/">os</a> <a class="post-tag" href="/tags/pipex/">pipex</a> <a class="post-tag" href="/tags/born2beroot/">born2beroot</a> <a class="post-tag" href="/tags/git/">git</a> <a class="post-tag" href="/tags/data-structure/">data structure</a> <a class="post-tag" href="/tags/docker/">docker</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://han-joon-hyeok.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"><div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>{categories}</div><div><i class="fa fa-tag fa-fw"></i>{tags}</div></div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>' }); </script>
